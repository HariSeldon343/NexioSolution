{
  "permissions": {
    "allow": [
      "Bash(mysql:*)",
      "Bash(grep:*)",
      "Bash(php:*)",
      "Bash(rm:*)",
      "Bash(find:*)",
      "Bash(mkdir:*)",
      "Bash(/opt/lampp/bin/mysql:*)",
      "Bash(sudo rm:*)",
      "Bash(ls:*)",
      "Bash(chmod:*)",
      "Bash(cp:*)",
      "Bash(/opt/lampp/bin/php:*)",
      "Bash(sudo systemctl:*)",
      "Bash(systemctl:*)",
      "Bash(composer show:*)",
      "Bash(composer require:*)",
      "Bash(ping:*)",
      "Bash(nc:*)",
      "Bash(sudo apt-get:*)",
      "Bash(sudo apt-get install:*)",
      "Bash(mv:*)",
      "Bash(touch:*)",
      "Bash(./scripts/setup-password-expiry-cron.sh:*)",
      "Bash(bash:*)",
      "Bash(# Configurazione diretta del cron job\nCRON_SCRIPT=\"\"/opt/lampp/htdocs/piattaforma-collaborativa/cron/check-password-expiry.php\"\"\nCRON_LOG=\"\"/opt/lampp/htdocs/piattaforma-collaborativa/logs/password-expiry-cron.log\"\"\nCRON_CMD=\"\"/opt/lampp/bin/php $CRON_SCRIPT >> $CRON_LOG 2>&1\"\"\nCRON_ENTRY=\"\"0 8 * * * $CRON_CMD\"\"\n\n# Rimuovi eventuale cron job esistente\ncrontab -l 2>/dev/null | grep -v \"\"check-password-expiry.php\"\" | crontab -\n\n# Aggiungi il nuovo cron job\n(crontab -l 2>/dev/null; echo \"\"$CRON_ENTRY\"\") | crontab -\n\necho \"\"✅ Cron job configurato con successo!\"\"\ncrontab -l | grep \"\"check-password-expiry\"\")",
      "Bash(curl:*)",
      "Bash(/opt/lampp/lampp:*)",
      "Bash(sudo /opt/lampp/lampp:*)",
      "Bash(sed:*)",
      "Bash(tar:*)",
      "Bash(/mnt/c/xampp/php/php.exe create-database-views.php:*)",
      "Bash(/mnt/c/xampp/php/php.exe fix-tasks-table.php)",
      "Bash(/usr/bin/php:*)",
      "Bash(/mnt/c/xampp/php/php.exe auto-fix-creata-da.php)",
      "Bash(/mnt/c/xampp/php/php.exe:*)",
      "Bash(/mnt/c/xampp/php/php -l /mnt/c/xampp/htdocs/piattaforma-collaborativa/filesystem.php)",
      "Bash(/mnt/c/xampp/php/php complete-filesystem-setup.php)",
      "Bash(/mnt/c/xampp/php/php fix-cartelle-constraint.php)",
      "Bash(/c/xampp/php/php.exe fix-namespace-references.php)",
      "Bash(/mnt/c/xampp/mysql/bin/mysql.exe:*)",
      "Bash(/mnt/c/xampp/php/php create-cartelle-table-minimal.php)",
      "Bash(cat:*)",
      "Bash(/mnt/c/xampp/php/php -l backend/api/folders-api.php)",
      "Bash(/mnt/c/xampp/php/php /mnt/c/xampp/htdocs/piattaforma-collaborativa/setup-company-folders.php)",
      "Bash(/mnt/c/xampp/php/php scripts/setup-company-folders.php)",
      "WebFetch(domain:localhost)",
      "Bash(/mnt/c/xampp/php/php fix-folder-permissions.php)",
      "Bash(true)",
      "Bash(/mnt/c/xampp/php/php -l dashboard.php)",
      "Bash(locate:*)",
      "Bash(/mnt/c/xampp/php/php /mnt/c/xampp/htdocs/piattaforma-collaborativa/test-api-final.php)",
      "Bash(/mnt/c/xampp/php/php -l /mnt/c/xampp/htdocs/piattaforma-collaborativa/backend/api/upload-multiple.php)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT TABLE_NAME, TABLE_ROWS, (DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024 AS ''Size_MB'' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'' ORDER BY TABLE_NAME;\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT COUNT(*) as total_tables FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'';\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT TABLE_TYPE, COUNT(*) as count FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'' GROUP BY TABLE_TYPE;\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT \n    TABLE_NAME as tabella,\n    TABLE_ROWS as righe,\n    ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024, 2) as size_mb\nFROM INFORMATION_SCHEMA.TABLES \nWHERE TABLE_SCHEMA = ''NexioSol''\n    AND TABLE_ROWS = 0\n    AND TABLE_TYPE = ''BASE TABLE''\n    AND TABLE_NAME NOT IN (\n        ''sessioni_utente'', ''rate_limit_attempts'', ''password_history'',\n        ''file_access_logs'', ''filesystem_logs'', ''activity_logs''\n    )\nORDER BY TABLE_NAME;\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT \n    TABLE_NAME as tabella,\n    COLUMN_NAME as colonna,\n    REFERENCED_TABLE_NAME as tabella_riferita,\n    REFERENCED_COLUMN_NAME as colonna_riferita\nFROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE\nWHERE TABLE_SCHEMA = ''NexioSol''\n    AND REFERENCED_TABLE_NAME IS NOT NULL\nORDER BY TABLE_NAME, COLUMN_NAME;\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SET @backup_verified = ''NO''; SET @dry_run = ''YES''; SELECT CASE WHEN @backup_verified != ''YES'' THEN ''ERRORE: Verificare prima il backup!'' WHEN @dry_run = ''YES'' THEN ''MODALITA DRY-RUN: Nessuna modifica sarà apportata'' ELSE ''ATTENZIONE: Modifiche reali in corso!'' END as STATO_ESECUZIONE;\" NexioSol)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT ''TABELLE DA RIMUOVERE'' as categoria, TABLE_NAME as tabella, TABLE_ROWS as righe, ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024, 2) as size_mb, ''ISO non implementato'' as motivo FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'' AND TABLE_NAME IN (''aziende_iso_config'',''aziende_iso_folders'',''classificazioni_iso'',''iso_company_configurations'',''iso_compliance_check'',''iso_documents'',''impostazioni_iso_azienda'',''versioni_documenti_iso'') \nUNION ALL\nSELECT ''TABELLE DA RIMUOVERE'', TABLE_NAME, TABLE_ROWS, ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024, 2), ''Settoriali non utilizzate'' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'' AND TABLE_NAME IN (''autorizzazioni_sanitarie'',''checklist_conformita'',''conformita_azienda'')\nUNION ALL  \nSELECT ''TABELLE DA RIMUOVERE'', TABLE_NAME, TABLE_ROWS, ROUND((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024, 2), ''Sistema non implementato'' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = ''NexioSol'' AND TABLE_NAME IN (''gdpr_consent'',''newsletter'',''rate_limit_blacklist'',''rate_limit_whitelist'',''ip_blacklist'',''ip_whitelist'',''temi_azienda'',''allegati'',''classificazioni'');\" NexioSol)",
      "Bash(git add:*)",
      "Bash(git config:*)",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SELECT ''Creating backup before file cleanup...'' as status;\")",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root --database=NexioSol -e \"SELECT COUNT(*) as total_tables FROM information_schema.tables WHERE table_schema=''NexioSol'';\")",
      "Bash(\"/mnt/c/xampp/mysql/bin/mysql.exe\" -u root -e \"SHOW TABLES LIKE ''tasks'';\" NexioSol)",
      "Bash(git commit:*)",
      "Bash(/mnt/c/xampp/php/php /mnt/c/xampp/htdocs/piattaforma-collaborativa/test-filesystem-permissions.php)",
      "Bash(/mnt/c/xampp/php/php debug_aziende_issues.php)",
      "Bash(./mysql:*)",
      "Bash(node:*)"
    ],
    "deny": []
  }
}