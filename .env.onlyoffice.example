# OnlyOffice Configuration Environment Variables
# Copy this file to .env.onlyoffice and configure for your environment

# ==============================================================================
# ENVIRONMENT SETTINGS
# ==============================================================================

# Application environment (development|staging|production)
APP_ENV=production

# ==============================================================================
# ONLYOFFICE SERVER URLS
# ==============================================================================

# Public URL - Used by browser to connect to OnlyOffice Document Server
# This should be accessible from client browsers
ONLYOFFICE_DS_PUBLIC_URL=https://office.yourdomain.com

# Internal URL - Used by PHP server to connect to OnlyOffice Document Server
# Can be different in Docker/Kubernetes environments
ONLYOFFICE_DS_INTERNAL_URL=http://onlyoffice-documentserver:80

# Callback URL - Where OnlyOffice sends save callbacks
# Leave empty to auto-detect, or set explicitly for complex network setups
ONLYOFFICE_CALLBACK_URL=https://yourdomain.com/backend/api/onlyoffice-callback.php

# Callback Host for Docker environments
# Use 'host.docker.internal' for Docker on Windows/Mac
ONLYOFFICE_CALLBACK_HOST=host.docker.internal

# ==============================================================================
# JWT SECURITY (REQUIRED FOR PRODUCTION)
# ==============================================================================

# Enable JWT authentication (MUST be true in production)
ONLYOFFICE_JWT_ENABLED=true

# JWT Secret Key - CRITICAL: Use a strong, unique secret key
# Generate with: openssl rand -hex 32
ONLYOFFICE_JWT_SECRET=your-very-secure-jwt-secret-key-here-change-this

# JWT Algorithm (HS256 or HS512)
ONLYOFFICE_JWT_ALGORITHM=HS256

# JWT Header name
ONLYOFFICE_JWT_HEADER=Authorization

# ==============================================================================
# SECURITY SETTINGS
# ==============================================================================

# Rate limiting - Max requests per minute per IP (0 = disabled)
ONLYOFFICE_RATE_LIMIT=60

# Allowed callback IPs (comma-separated, empty = allow all)
# Example: ONLYOFFICE_ALLOWED_IPS=10.0.0.1,192.168.1.100
ONLYOFFICE_ALLOWED_IPS=

# CORS allowed origins (comma-separated, * = allow all)
# Example: ONLYOFFICE_CORS_ORIGINS=https://app.yourdomain.com,https://office.yourdomain.com
ONLYOFFICE_CORS_ORIGINS=*

# ==============================================================================
# OPERATIONAL SETTINGS
# ==============================================================================

# Request timeout in seconds
ONLYOFFICE_TIMEOUT=30

# Maximum file size in bytes (100MB default)
ONLYOFFICE_MAX_FILE_SIZE=104857600

# Session timeout for editing in seconds (3600 = 1 hour)
ONLYOFFICE_SESSION_TIMEOUT=3600

# Documents storage directory (absolute path)
ONLYOFFICE_DOCUMENTS_DIR=/var/www/documents/onlyoffice

# ==============================================================================
# LOGGING AND DEBUGGING
# ==============================================================================

# Enable debug mode (false in production)
ONLYOFFICE_DEBUG=false

# Log file path
ONLYOFFICE_LOG_FILE=/var/log/onlyoffice/callback.log

# ==============================================================================
# DATABASE VERSIONING (Optional)
# ==============================================================================

# Enable document versioning
ONLYOFFICE_VERSIONING_ENABLED=true

# Maximum versions to keep per document
ONLYOFFICE_MAX_VERSIONS=50

# Auto-create major version on manual save
ONLYOFFICE_MAJOR_ON_MANUAL_SAVE=true

# ==============================================================================
# ADVANCED SETTINGS
# ==============================================================================

# Enable collaborative editing features
ONLYOFFICE_COLLABORATIVE_EDITING=true

# Track active editors
ONLYOFFICE_TRACK_ACTIVE_EDITORS=true

# Enable change tracking
ONLYOFFICE_TRACK_CHANGES=true

# Enable comments
ONLYOFFICE_ENABLE_COMMENTS=true

# Enable chat
ONLYOFFICE_ENABLE_CHAT=false

# Force save types (comma-separated: manual,timer,exit)
ONLYOFFICE_FORCE_SAVE_TYPES=manual,timer,exit

# Force save timer interval in milliseconds (300000 = 5 minutes)
ONLYOFFICE_FORCE_SAVE_TIMER=300000

# ==============================================================================
# DOCKER/KUBERNETES SETTINGS
# ==============================================================================

# Docker network name (if using Docker Compose)
ONLYOFFICE_DOCKER_NETWORK=onlyoffice-network

# Kubernetes namespace (if using K8s)
ONLYOFFICE_K8S_NAMESPACE=default

# Service name in Docker/K8s
ONLYOFFICE_SERVICE_NAME=onlyoffice-documentserver

# ==============================================================================
# SSL/TLS SETTINGS
# ==============================================================================

# Verify SSL certificates (true in production)
ONLYOFFICE_VERIFY_SSL=true

# Custom CA certificate path (if using self-signed certificates)
ONLYOFFICE_CA_CERT_PATH=

# Client certificate for mutual TLS (if required)
ONLYOFFICE_CLIENT_CERT_PATH=
ONLYOFFICE_CLIENT_KEY_PATH=

# ==============================================================================
# MONITORING AND HEALTH CHECKS
# ==============================================================================

# Enable health checks
ONLYOFFICE_HEALTH_CHECK_ENABLED=true

# Health check interval in seconds
ONLYOFFICE_HEALTH_CHECK_INTERVAL=60

# Alert email for critical errors
ONLYOFFICE_ALERT_EMAIL=admin@yourdomain.com

# Webhook URL for monitoring (e.g., Slack, Discord, etc.)
ONLYOFFICE_MONITORING_WEBHOOK=

# ==============================================================================
# BACKUP AND RECOVERY
# ==============================================================================

# Enable automatic document backup
ONLYOFFICE_BACKUP_ENABLED=true

# Backup directory
ONLYOFFICE_BACKUP_DIR=/var/backups/onlyoffice

# Backup retention days
ONLYOFFICE_BACKUP_RETENTION_DAYS=30

# ==============================================================================
# PERFORMANCE TUNING
# ==============================================================================

# Maximum concurrent editors per document
ONLYOFFICE_MAX_CONCURRENT_EDITORS=20

# Cache TTL in seconds
ONLYOFFICE_CACHE_TTL=3600

# Enable document preloading
ONLYOFFICE_PRELOAD_DOCUMENTS=false

# Memory limit for document processing
ONLYOFFICE_MEMORY_LIMIT=512M

# ==============================================================================
# INTEGRATION SETTINGS
# ==============================================================================

# Enable Nexio platform integration
ONLYOFFICE_NEXIO_INTEGRATION=true

# Nexio API endpoint
ONLYOFFICE_NEXIO_API_URL=https://yourdomain.com/backend/api

# Nexio API key (if required)
ONLYOFFICE_NEXIO_API_KEY=

# ==============================================================================
# NOTES
# ==============================================================================
# 
# 1. CRITICAL: Always use HTTPS in production
# 2. CRITICAL: Set a strong JWT secret key
# 3. IMPORTANT: Configure firewall rules to restrict OnlyOffice server access
# 4. RECOMMENDED: Use Redis for session storage in multi-server setups
# 5. RECOMMENDED: Configure proper backup strategy for documents
# 6. RECOMMENDED: Monitor OnlyOffice server resources and adjust limits accordingly
#
# For Docker deployment:
# - Ensure OnlyOffice container can reach the callback URL
# - Use Docker secrets for sensitive values in production
#
# For Kubernetes deployment:
# - Use ConfigMaps for non-sensitive configuration
# - Use Secrets for sensitive values like JWT secret
# - Configure proper network policies
#
# Security Checklist:
# [ ] JWT enabled and secret key configured
# [ ] HTTPS enforced for all connections
# [ ] Rate limiting configured
# [ ] IP whitelist configured (if applicable)
# [ ] SSL certificate verification enabled
# [ ] Logs properly secured and rotated
# [ ] Backup strategy implemented
# [ ] Monitoring and alerting configured
#
# ==============================================================================