server {
    listen 8080;
    server_name localhost;

    # Serve documents from mounted volume
    location /documents/ {
        alias /var/www/onlyoffice/documents/;
        autoindex off;
        
        # Allow OnlyOffice to download files
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS";
        add_header Access-Control-Allow-Headers "Range";
        
        # Set proper MIME types
        location ~ \.docx$ {
            add_header Content-Type "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
        }
        location ~ \.xlsx$ {
            add_header Content-Type "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        }
        location ~ \.pptx$ {
            add_header Content-Type "application/vnd.openxmlformats-officedocument.presentationml.presentation";
        }
    }
    
    # Health check endpoint
    location /health {
        return 200 "OK";
        add_header Content-Type text/plain;
    }
}